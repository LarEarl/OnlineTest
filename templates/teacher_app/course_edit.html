{% extends 'base.html' %}
{% block title %}Редактировать курс{% endblock %}
{% block content %}
<div class="container">
  <h1>Редактирование курса: {{ course.title }}</h1>
  <form method="post" enctype="multipart/form-data" style="margin-top:15px; background:#f8f9fa; padding:20px; border-radius:8px;">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div>{{ form.title.label_tag }}{{ form.title }}</div>
    <div>{{ form.description.label_tag }}{{ form.description }}</div>
    <div>{{ form.image.label_tag }}{{ form.image }}</div>
    <div>{{ form.slug.label_tag }}{{ form.slug }}</div>
    <div>{{ form.is_posted.label_tag }}{{ form.is_posted }}</div>
    <button type="submit">Сохранить</button>
    <a href="{% url 'teacher_app:courses' %}" style="margin-left:10px;">Отмена</a>
  </form>
</div>
<script>
const translitMap = {
  'а':'a','б':'b','в':'v','г':'g','д':'d','е':'e','ё':'e','ж':'zh','з':'z','и':'i','й':'y','к':'k','л':'l','м':'m','н':'n','о':'o','п':'p','р':'r','с':'s','т':'t','у':'u','ф':'f','х':'h','ц':'ts','ч':'ch','ш':'sh','щ':'sch','ъ':'','ы':'y','ь':'','э':'e','ю':'yu','я':'ya',
  'А':'A','Б':'B','В':'V','Г':'G','Д':'D','Е':'E','Ё':'E','Ж':'Zh','З':'Z','И':'I','Й':'Y','К':'K','Л':'L','М':'M','Н':'N','О':'O','П':'P','Р':'R','С':'S','Т':'T','У':'U','Ф':'F','Х':'H','Ц':'Ts','Ч':'Ch','Ш':'Sh','Щ':'Sch','Ъ':'','Ы':'Y','Ь':'','Э':'E','Ю':'Yu','Я':'Ya'
};
function transliterate(text) {
  return text.split('').map(c => translitMap[c] || c).join('');
}
function generateSlug(text) {
  return transliterate(text).toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '');
}
const titleInput = document.querySelector('[name="title"]');
const slugInput = document.querySelector('[name="slug"]');
if (titleInput && slugInput) {
  titleInput.addEventListener('input', function() {
    if (!slugInput.dataset.edited) {
      slugInput.value = generateSlug(this.value);
    }
  });
  slugInput.addEventListener('input', function() {
    this.dataset.edited = 'true';
  });
}
</script>
{% endblock %}
