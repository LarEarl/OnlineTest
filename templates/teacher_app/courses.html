{% extends 'base.html' %}
{% block title %}–£—á–∏—Ç–µ–ª—å—Å–∫–∞—è - –ö—É—Ä—Å—ã{% endblock %}
{% block content %}
<div class="container">
  <h1>üìö –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏</h1>
  <p style="color:#7f8c8d; margin-bottom:15px;">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫—É—Ä—Å—ã ‚Äî slug –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ –ø—Ä–∏–º–µ—Ä–∞.</p>

  <form method="post" enctype="multipart/form-data" style="margin-bottom:25px; background:#f8f9fa; padding:20px; border-radius:8px;">
    {% csrf_token %}
    {{ form.non_field_errors }}
    <div>{{ form.title.label_tag }}{{ form.title }}</div>
    <div>{{ form.description.label_tag }}{{ form.description }}</div>
    <div>{{ form.image.label_tag }}{{ form.image }}</div>
    <div>{{ form.slug.label_tag }}{{ form.slug }}</div>
    <div>{{ form.is_posted.label_tag }}{{ form.is_posted }}</div>
    <button type="submit">–°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å</button>
  </form>

  <h2>–°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤</h2>
  <div class="modules-list" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:15px;">
    {% for course in courses %}
    <div class="module-card" style="background:#fff;border-radius:8px;padding:15px;box-shadow:0 2px 10px rgba(0,0,0,0.08);">
      <h3 style="color:#2c3e50;">{{ course.title }}</h3>
      <p style="color:#7f8c8d; font-size:0.95em;">{{ course.description|truncatechars:120 }}</p>
      <p style="color:#95a5a6; font-size:0.85em;">slug: {{ course.slug }}</p>
      <p style="color:#27ae60; font-size:0.85em;">{{ course.modules.count }} –º–æ–¥—É–ª–µ–π</p>
      <a href="{% url 'teacher_app:course_edit' course.pk %}" style="color:#2980b9; font-size:0.9em;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
    </div>
    {% empty %}
    <p>–ü–æ–∫–∞ –Ω–µ—Ç –∫—É—Ä—Å–æ–≤.</p>
    {% endfor %}
  </div>
</div>
<script>
const translitMap = {
  '–∞':'a','–±':'b','–≤':'v','–≥':'g','–¥':'d','–µ':'e','—ë':'e','–∂':'zh','–∑':'z','–∏':'i','–π':'y','–∫':'k','–ª':'l','–º':'m','–Ω':'n','–æ':'o','–ø':'p','—Ä':'r','—Å':'s','—Ç':'t','—É':'u','—Ñ':'f','—Ö':'h','—Ü':'ts','—á':'ch','—à':'sh','—â':'sch','—ä':'','—ã':'y','—å':'','—ç':'e','—é':'yu','—è':'ya',
  '–ê':'A','–ë':'B','–í':'V','–ì':'G','–î':'D','–ï':'E','–Å':'E','–ñ':'Zh','–ó':'Z','–ò':'I','–ô':'Y','–ö':'K','–õ':'L','–ú':'M','–ù':'N','–û':'O','–ü':'P','–†':'R','–°':'S','–¢':'T','–£':'U','–§':'F','–•':'H','–¶':'Ts','–ß':'Ch','–®':'Sh','–©':'Sch','–™':'','–´':'Y','–¨':'','–≠':'E','–Æ':'Yu','–Ø':'Ya'
};
function transliterate(text) {
  return text.split('').map(c => translitMap[c] || c).join('');
}
function generateSlug(text) {
  return transliterate(text).toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '');
}
const titleInput = document.querySelector('[name="title"]');
const slugInput = document.querySelector('[name="slug"]');
if (titleInput && slugInput) {
  titleInput.addEventListener('input', function() {
    if (!slugInput.dataset.edited) {
      slugInput.value = generateSlug(this.value);
    }
  });
  slugInput.addEventListener('input', function() {
    this.dataset.edited = 'true';
  });
}
</script>
{% endblock %}
