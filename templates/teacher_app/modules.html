{% extends 'base.html' %}
{% block title %}–£—á–∏—Ç–µ–ª—å—Å–∫–∞—è - –ú–æ–¥—É–ª–∏{% endblock %}
{% block content %}
<div class="container">
  <h1>üìñ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è–º–∏</h1>
  <p style="color:#7f8c8d; margin-bottom:15px;">–£–∫–∞–∂–∏—Ç–µ –∫—É—Ä—Å, –Ω–∞–∑–≤–∞–Ω–∏–µ, –ø–æ—Ä—è–¥–æ–∫ –∏ slug.</p>

  <form method="post" style="margin-bottom:25px; background:#f8f9fa; padding:20px; border-radius:8px;">
    {% csrf_token %}
    {% if form.errors %}
      <div class="error">{{ form.non_field_errors }}
        {% for field in form %}
          {% for err in field.errors %}
            <div>{{ field.label }}: {{ err }}</div>
          {% endfor %}
        {% endfor %}
      </div>
    {% endif %}
    <div>{{ form.course.label_tag }}{{ form.course }}</div>
    <div>{{ form.name.label_tag }}{{ form.name }}</div>
    <div>{{ form.description.label_tag }}{{ form.description }}</div>
    <div>{{ form.slug.label_tag }}{{ form.slug }}</div>
    <div>{{ form.order.label_tag }}{{ form.order }}</div>
    <button type="submit">–°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å</button>
  </form>

  <h2>–°–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π</h2>
  <div class="modules-list" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:15px;">
    {% for module in modules %}
    <div class="module-card" style="background:#fff;border-radius:8px;padding:15px;box-shadow:0 2px 10px rgba(0,0,0,0.08);">
      <h3 style="color:#2c3e50;">{{ module.name }}</h3>
      <p style="color:#7f8c8d; font-size:0.95em;">–ö—É—Ä—Å: {{ module.course.title }}</p>
      <p style="color:#95a5a6; font-size:0.85em;">–ü–æ—Ä—è–¥–æ–∫: {{ module.order }}</p>
      <p style="color:#95a5a6; font-size:0.85em;">slug: {{ module.slug }}</p>
      <a href="{% url 'teacher_app:module_edit' module.pk %}" style="color:#2980b9; font-size:0.9em;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
    </div>
    {% empty %}
    <p>–ü–æ–∫–∞ –Ω–µ—Ç –º–æ–¥—É–ª–µ–π.</p>
    {% endfor %}
  </div>
</div>
<script>
const translitMap = {
  '–∞':'a','–±':'b','–≤':'v','–≥':'g','–¥':'d','–µ':'e','—ë':'e','–∂':'zh','–∑':'z','–∏':'i','–π':'y','–∫':'k','–ª':'l','–º':'m','–Ω':'n','–æ':'o','–ø':'p','—Ä':'r','—Å':'s','—Ç':'t','—É':'u','—Ñ':'f','—Ö':'h','—Ü':'ts','—á':'ch','—à':'sh','—â':'sch','—ä':'','—ã':'y','—å':'','—ç':'e','—é':'yu','—è':'ya',
  '–ê':'A','–ë':'B','–í':'V','–ì':'G','–î':'D','–ï':'E','–Å':'E','–ñ':'Zh','–ó':'Z','–ò':'I','–ô':'Y','–ö':'K','–õ':'L','–ú':'M','–ù':'N','–û':'O','–ü':'P','–†':'R','–°':'S','–¢':'T','–£':'U','–§':'F','–•':'H','–¶':'Ts','–ß':'Ch','–®':'Sh','–©':'Sch','–™':'','–´':'Y','–¨':'','–≠':'E','–Æ':'Yu','–Ø':'Ya'
};
function transliterate(text) {
  return text.split('').map(c => translitMap[c] || c).join('');
}
function generateSlug(text) {
  return transliterate(text).toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-+|-+$/g, '');
}
const nameInput = document.querySelector('[name="name"]');
const slugInput = document.querySelector('[name="slug"]');
if (nameInput && slugInput) {
  nameInput.addEventListener('input', function() {
    if (!slugInput.dataset.edited) {
      slugInput.value = generateSlug(this.value);
    }
  });
  slugInput.addEventListener('input', function() {
    this.dataset.edited = 'true';
  });
}
</script>
{% endblock %}
